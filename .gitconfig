[user]
  name = Hiroshi Ogawa
  email = hi.ogawa.zz@gmail.com
  # https://docs.github.com/en/authentication/managing-commit-signature-verification/telling-git-about-your-signing-key#telling-git-about-your-ssh-key
  signingkey = ~/.ssh/id_ed25519.pub

[alias]
  st = status
  ci = commit
  co = checkout
  br = branch
  lg = log --graph --oneline
  lga = log --graph --oneline --all

  # checkout stack log
  co-lg = "! for ((i=1; i<${1:-10}; i++)); do echo -n \"$i: \"; git rev-parse --symbolic-full-name @{-$i} 2>/dev/null; done && true"
  co-co = "! git checkout @{-${1}} && true"

  # Fetch and merge fast-forward (thus "safe" pull)
  # $ git sfpl <remote=origin>
  sfpl = "! remote=${1:-origin} && branch=$(git rev-parse --abbrev-ref HEAD) && git fetch --no-tags $remote $branch && git merge --ff-only $remote/$branch && true"

  # Clone current repo remotes into a new directory
  # $ git cp-clone <target-dir>
  cp-clone = "!f(){ target=\"$1\"; [ -n \"$target\" ] || { echo 'usage: git cp-clone <target-dir>' >&2; return 1; }; origin_url=$(git remote get-url origin) || return 1; upstream_url=$(git remote get-url upstream 2>/dev/null || true); git clone \"$origin_url\" \"$target\" || return 1; if [ -n \"$upstream_url\" ]; then git -C \"$target\" remote add upstream \"$upstream_url\"; fi; }; f"

  # Fetch remote and checkout
  # $ git fco <branch> <remote=origin>
  fco = "! branch=${1} remote=${2:-origin} && git fetch --no-tags $remote $branch && git checkout -B $branch $remote/$branch && true"

  # Fetch remote and checkout (default: branch=main, remote=upstream->origin)
  # $ git fco-x <branch=main> <remote=upstream|origin>
  fco-x = "! branch=${1:-main}; remote=${2:-}; if [ -z \"$remote\" ]; then git remote get-url upstream >/dev/null 2>&1 && remote=upstream || remote=origin; fi; git fetch --no-tags \"$remote\" \"$branch\" && git checkout -B \"$branch\" \"$remote/$branch\" && true"

[init]
  defaultBranch = main

[core]
  autocrlf = false
  editor = nano
  excludesfile = ~/.gitignore-global

[color]
  ui = auto

[commit]
  gpgsign = true

[diff]
  tool = vscode

[difftool "vscode"]
  # e.g. git difftool main -- some-path
  cmd = code --wait --diff $LOCAL $REMOTE

[push]
  autoSetupRemote = true

[gpg]
  format = ssh
